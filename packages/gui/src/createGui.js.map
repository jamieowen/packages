{
  "version": 3,
  "sources": ["/Users/jamieowen/Workspace/packages/packages/gui/src/createGui.ts"],
  "sourcesContent": ["import { GUI, GUIController } from \"dat.gui\";\nimport { Stream } from \"@thi.ng/rstream\";\nimport { keyboardStream } from \"@jamieowen/browser\";\n\nconst guiListen = (gui: GUI, callback: () => void) => {\n  gui.__controllers.forEach((c) => c.onChange(callback));\n  Object.values(gui.__folders).forEach((g) => guiListen(g, callback));\n};\n// type Value = string | number |\nexport function createGui<T>(controls: T) {\n  // Create dat.gui\n  const gui = new GUI({\n    width: 350,\n    closed: true,\n  });\n\n  keyboardStream({\n    toggle: [\"k\"],\n  }).subscribe({\n    next: (ev) => {\n      console.log(ev);\n      if (ev.isKeyToggled && ev.keysToggled.indexOf(\"k\") > -1) {\n        gui.hide();\n      } else {\n        gui.show();\n      }\n    },\n  });\n\n  gui.domElement.parentElement.style.zIndex = \"100\";\n  // Convert controls object to gui compatible\n  const values: Partial<Record<keyof T, any>> = {};\n  Object.entries(controls).forEach(([key, value]) => {\n    let control: GUIController;\n    // Add item array\n    if (value instanceof Array) {\n      // number, min/max shorthand.\n      if (value.length === 4 && typeof value[0] === \"number\") {\n        values[key as keyof T] = value[0];\n        control = gui.add(values, key, value[1], value[2], value[3]);\n      } else {\n        values[key as keyof T] = value[0];\n        control = gui.add(values, key, value);\n      }\n    } else if (typeof value === \"function\") {\n      // add function ref directly\n      control = gui.add(controls, key);\n    } else {\n      // copy values to new object\n      values[key as keyof T] = value;\n      control = gui.add(values, key);\n    }\n\n    // control.name(key.toUpperCase());\n  });\n\n  const stream = new Stream<{\n    gui: GUI;\n    values: typeof values;\n  }>(($) => {\n    guiListen(gui, () => {\n      $.next({\n        values,\n        gui,\n      });\n    });\n  });\n  stream.next({\n    values,\n    gui,\n  });\n  return stream;\n}\n"],
  "mappings": "AAAA;AACA;AACA;AAEA,MAAM,YAAY,CAAC,KAAU,aAAyB;AACpD,MAAI,cAAc,QAAQ,CAAC,MAAM,EAAE,SAAS;AAC5C,SAAO,OAAO,IAAI,WAAW,QAAQ,CAAC,MAAM,UAAU,GAAG;AAAA;AAGpD,0BAAsB,UAAa;AAExC,QAAM,MAAM,IAAI,IAAI;AAAA,IAClB,OAAO;AAAA,IACP,QAAQ;AAAA;AAGV,iBAAe;AAAA,IACb,QAAQ,CAAC;AAAA,KACR,UAAU;AAAA,IACX,MAAM,CAAC,OAAO;AACZ,cAAQ,IAAI;AACZ,UAAI,GAAG,gBAAgB,GAAG,YAAY,QAAQ,OAAO,IAAI;AACvD,YAAI;AAAA,aACC;AACL,YAAI;AAAA;AAAA;AAAA;AAKV,MAAI,WAAW,cAAc,MAAM,SAAS;AAE5C,QAAM,SAAwC;AAC9C,SAAO,QAAQ,UAAU,QAAQ,CAAC,CAAC,KAAK,WAAW;AACjD,QAAI;AAEJ,QAAI,iBAAiB,OAAO;AAE1B,UAAI,MAAM,WAAW,KAAK,OAAO,MAAM,OAAO,UAAU;AACtD,eAAO,OAAkB,MAAM;AAC/B,kBAAU,IAAI,IAAI,QAAQ,KAAK,MAAM,IAAI,MAAM,IAAI,MAAM;AAAA,aACpD;AACL,eAAO,OAAkB,MAAM;AAC/B,kBAAU,IAAI,IAAI,QAAQ,KAAK;AAAA;AAAA,eAExB,OAAO,UAAU,YAAY;AAEtC,gBAAU,IAAI,IAAI,UAAU;AAAA,WACvB;AAEL,aAAO,OAAkB;AACzB,gBAAU,IAAI,IAAI,QAAQ;AAAA;AAAA;AAM9B,QAAM,SAAS,IAAI,OAGhB,CAAC,MAAM;AACR,cAAU,KAAK,MAAM;AACnB,QAAE,KAAK;AAAA,QACL;AAAA,QACA;AAAA;AAAA;AAAA;AAIN,SAAO,KAAK;AAAA,IACV;AAAA,IACA;AAAA;AAEF,SAAO;AAAA;",
  "names": []
}
