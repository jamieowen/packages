{"version":3,"file":"subscription-3ccab2d1.js","sources":["../../../../../node_modules/@thi.ng/checks/is-function.js","../../../../../node_modules/@thi.ng/rstream/api.js","../../../../../node_modules/@thi.ng/errors/illegal-state.js","../../../../../node_modules/@thi.ng/arrays/peek.js","../../../../../node_modules/@thi.ng/rstream/utils/idgen.js","../../../../../node_modules/@thi.ng/rstream/subscription.js"],"sourcesContent":["export const isFunction = (x) => typeof x === \"function\";\n","import { NULL_LOGGER } from \"@thi.ng/api\";\nexport var State;\n(function (State) {\n    State[State[\"IDLE\"] = 0] = \"IDLE\";\n    State[State[\"ACTIVE\"] = 1] = \"ACTIVE\";\n    State[State[\"DONE\"] = 2] = \"DONE\";\n    State[State[\"ERROR\"] = 3] = \"ERROR\";\n    State[State[\"DISABLED\"] = 4] = \"DISABLED\";\n})(State || (State = {}));\n/**\n * Closing behaviors.\n */\nexport var CloseMode;\n(function (CloseMode) {\n    /**\n     * Never close, even if no more inputs/outputs.\n     */\n    CloseMode[CloseMode[\"NEVER\"] = 0] = \"NEVER\";\n    /**\n     * Close when first input/output is done / removed.\n     */\n    CloseMode[CloseMode[\"FIRST\"] = 1] = \"FIRST\";\n    /**\n     * Close when last input/output is done / removed.\n     */\n    CloseMode[CloseMode[\"LAST\"] = 2] = \"LAST\";\n})(CloseMode || (CloseMode = {}));\nexport let LOGGER = NULL_LOGGER;\nexport const setLogger = (logger) => (LOGGER = logger);\n","import { defError } from \"./deferror\";\nexport const IllegalStateError = defError(() => \"illegal state\");\nexport const illegalState = (msg) => {\n    throw new IllegalStateError(msg);\n};\n","/**\n * Returns first element of given array or `undefined` if array is empty.\n *\n * @param buf - array\n */\nexport const first = (buf) => buf[0];\n/**\n * Returns last element of given array or `undefined` if array is empty.\n *\n * @param buf - array\n */\nexport const peek = (buf) => buf[buf.length - 1];\n","let NEXT_ID = 0;\nexport const nextID = () => NEXT_ID++;\nexport const optsWithID = (prefix, opts) => ((!opts || !opts.id ? Object.assign(Object.assign({}, opts), { id: prefix + \"-\" + nextID() }) : opts));\n","import { SEMAPHORE } from \"@thi.ng/api\";\nimport { peek } from \"@thi.ng/arrays\";\nimport { implementsFunction, isFunction, isPlainObject } from \"@thi.ng/checks\";\nimport { illegalArity, illegalState } from \"@thi.ng/errors\";\nimport { comp, isReduced, map, push, unreduced, } from \"@thi.ng/transducers\";\nimport { CloseMode, LOGGER, State, } from \"./api\";\nimport { nextID } from \"./utils/idgen\";\n/**\n * Creates a new {@link Subscription} instance, the fundamental datatype\n * and building block provided by this package.\n *\n * @remarks\n * Most other types in rstream, including {@link Stream}s, are\n * `Subscription`s and all can be:\n *\n * - connected into directed graphs (sync or async & not necessarily\n *   DAGs)\n * - transformed using transducers (incl. support for early termination)\n * - can have any number of subscribers (optionally each w/ their own\n *   transducers)\n * - recursively unsubscribe themselves from parent after their last\n *   subscriber unsubscribed (configurable)\n * - will go into a non-recoverable error state if none of the\n *   subscribers has an error handler itself\n * - implement the {@link @thi.ng/api#IDeref} interface\n *\n * If a transducer is provided (via the `xform` option), all received\n * values will be first processed by the transducer and only its\n * transformed result(s) (if any) will be passed to downstream\n * subscribers. Any uncaught errors *inside* the transducer will cause\n * this subscription's error handler to be called and will stop this\n * subscription from receiving any further values (by default, unless\n * overridden).\n *\n * Subscription behavior can be customized via the additional (optional)\n * options arg. See {@link CommonOpts} and {@link SubscriptionOpts} for\n * further details.\n *\n * @example\n * ```ts\n * // as reactive value mechanism (same as with stream() above)\n * s = subscription();\n * s.subscribe(trace(\"s1\"));\n * s.subscribe(trace(\"s2\"), { xform: tx.filter((x) => x > 25) });\n *\n * // external trigger\n * s.next(23);\n * // s1 23\n * s.next(42);\n * // s1 42\n * // s2 42\n * ```\n *\n * @param sub -\n * @param opts -\n */\nexport const subscription = (sub, opts) => new Subscription(sub, opts);\nexport class Subscription {\n    constructor(sub, opts = {}) {\n        this.state = State.IDLE;\n        this.parent = opts.parent;\n        this.closeIn =\n            opts.closeIn !== undefined ? opts.closeIn : CloseMode.LAST;\n        this.closeOut =\n            opts.closeOut !== undefined ? opts.closeOut : CloseMode.LAST;\n        this.cacheLast = opts.cache !== false;\n        this.id = opts.id || `sub-${nextID()}`;\n        this.last = SEMAPHORE;\n        this.subs = [];\n        if (sub) {\n            this.subs.push(sub);\n        }\n        if (opts.xform) {\n            this.xform = opts.xform(push());\n        }\n    }\n    deref() {\n        return this.last !== SEMAPHORE ? this.last : undefined;\n    }\n    getState() {\n        return this.state;\n    }\n    subscribe(...args) {\n        this.ensureState();\n        let sub;\n        !peek(args) && args.pop();\n        const opts = args.length > 1 && isPlainObject(peek(args))\n            ? Object.assign({}, args.pop()) : {};\n        switch (args.length) {\n            case 1:\n                if (isFunction(args[0])) {\n                    opts.xform = args[0];\n                    !opts.id && (opts.id = `xform-${nextID()}`);\n                }\n                else {\n                    sub = args[0];\n                }\n                break;\n            case 2:\n                sub = args[0];\n                opts.xform = args[1];\n                break;\n            default:\n                illegalArity(args.length);\n        }\n        if (implementsFunction(sub, \"subscribe\") && !opts.xform) {\n            sub.parent = this;\n        }\n        else {\n            // FIXME inherit options from this sub or defaults?\n            sub = subscription(sub, Object.assign({ parent: this }, opts));\n        }\n        this.last !== SEMAPHORE && sub.next(this.last);\n        return this.addWrapped(sub);\n    }\n    /**\n     * Returns array of new child subscriptions for all given\n     * subscribers.\n     *\n     * @param subs -\n     */\n    subscribeAll(...subs) {\n        const wrapped = [];\n        for (let s of subs) {\n            wrapped.push(this.subscribe(s));\n        }\n        return wrapped;\n    }\n    transform(...xf) {\n        const n = xf.length - 1;\n        return isPlainObject(xf[n])\n            ? this.subscribe(comp(...xf.slice(0, n)), xf[n])\n            : this.subscribe(comp(...xf));\n    }\n    /**\n     * Syntax sugar for {@link Subscription.transform} when using a\n     * single {@link @thi.ng/transducers#map} transducer only. The given\n     * function `fn` is used as `map`'s transformation fn.\n     *\n     * @param fn\n     * @param opts\n     */\n    map(fn, opts) {\n        return this.subscribe(map(fn), opts);\n    }\n    /**\n     * If called without arg, removes this subscription from parent (if\n     * any), cleans up internal state and goes into DONE state. If\n     * called with arg, removes the sub from internal pool and if no\n     * other subs are remaining also cleans up itself and goes into DONE\n     * state.\n     *\n     * @param sub -\n     */\n    unsubscribe(sub) {\n        LOGGER.debug(this.id, \"unsub start\", sub ? sub.id : \"self\");\n        if (!sub) {\n            let res = true;\n            if (this.parent) {\n                res = this.parent.unsubscribe(this);\n            }\n            this.state = State.DONE;\n            this.cleanup();\n            return res;\n        }\n        LOGGER.debug(this.id, \"unsub child\", sub.id);\n        const idx = this.subs.indexOf(sub);\n        if (idx >= 0) {\n            this.subs.splice(idx, 1);\n            if (this.closeOut === CloseMode.FIRST ||\n                (!this.subs.length && this.closeOut !== CloseMode.NEVER)) {\n                this.unsubscribe();\n            }\n            return true;\n        }\n        return false;\n    }\n    next(x) {\n        if (this.state < State.DONE) {\n            if (this.xform) {\n                let acc;\n                try {\n                    acc = this.xform[2]([], x);\n                }\n                catch (e) {\n                    this.error(e);\n                    return;\n                }\n                const uacc = unreduced(acc);\n                const n = uacc.length;\n                for (let i = 0; i < n; i++) {\n                    this.dispatch(uacc[i]);\n                }\n                isReduced(acc) && this.done();\n            }\n            else {\n                this.dispatch(x);\n            }\n        }\n    }\n    done() {\n        LOGGER.debug(this.id, \"entering done()\");\n        if (this.state < State.DONE) {\n            try {\n                if (this.xform) {\n                    const acc = this.xform[1]([]);\n                    const uacc = unreduced(acc);\n                    const n = uacc.length;\n                    for (let i = 0; i < n; i++) {\n                        this.dispatch(uacc[i]);\n                    }\n                }\n            }\n            catch (e) {\n                this.error(e);\n                return;\n            }\n            this.state = State.DONE;\n            for (let s of this.subs.slice()) {\n                try {\n                    s.done && s.done();\n                }\n                catch (e) {\n                    s.error ? s.error(e) : this.error(e);\n                }\n            }\n            this.unsubscribe();\n            LOGGER.debug(this.id, \"exiting done()\");\n        }\n    }\n    error(e) {\n        this.state = State.ERROR;\n        const subs = this.subs;\n        let notified = false;\n        if (subs.length) {\n            for (let s of subs.slice()) {\n                if (s.error) {\n                    s.error(e);\n                    notified = true;\n                }\n            }\n        }\n        if (!notified) {\n            LOGGER.warn(this.id, \"unhandled error:\", e);\n            if (this.parent) {\n                LOGGER.debug(this.id, \"unsubscribing...\");\n                this.unsubscribe();\n                this.state = State.ERROR;\n            }\n        }\n    }\n    addWrapped(wrapped) {\n        this.subs.push(wrapped);\n        this.state = State.ACTIVE;\n        return wrapped;\n    }\n    dispatch(x) {\n        // LOGGER.debug(this.id, \"dispatch\", x);\n        this.cacheLast && (this.last = x);\n        const subs = this.subs;\n        let n = subs.length;\n        let s;\n        if (n === 1) {\n            s = subs[0];\n            try {\n                s.next && s.next(x);\n            }\n            catch (e) {\n                s.error ? s.error(e) : this.error(e);\n            }\n        }\n        else {\n            for (; --n >= 0;) {\n                s = subs[n];\n                try {\n                    s.next && s.next(x);\n                }\n                catch (e) {\n                    s.error ? s.error(e) : this.error(e);\n                }\n            }\n        }\n    }\n    ensureState() {\n        if (this.state >= State.DONE) {\n            illegalState(`operation not allowed in state ${this.state}`);\n        }\n    }\n    cleanup() {\n        LOGGER.debug(this.id, \"cleanup\");\n        this.subs.length = 0;\n        delete this.parent;\n        delete this.xform;\n        delete this.last;\n    }\n}\n"],"names":[],"mappings":"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"}