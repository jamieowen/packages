{"version":3,"file":"map-3e2f222d.js","sources":["../../../../../node_modules/@thi.ng/checks/implements-function.js","../../../../../node_modules/@thi.ng/checks/is-arraylike.js","../../../../../node_modules/@thi.ng/checks/is-iterable.js","../../../../../node_modules/@thi.ng/api/constants.js","../../../../../node_modules/@thi.ng/transducers/internal/ensure.js","../../../../../node_modules/@thi.ng/transducers/reduced.js","../../../../../node_modules/@thi.ng/errors/illegal-arity.js","../../../../../node_modules/@thi.ng/transducers/reduce.js","../../../../../node_modules/@thi.ng/transducers/rfn/push.js","../../../../../node_modules/@thi.ng/transducers/iterator.js","../../../../../node_modules/@thi.ng/transducers/func/compr.js","../../../../../node_modules/@thi.ng/transducers/xform/map.js"],"sourcesContent":["export const implementsFunction = (x, fn) => x != null && typeof x[fn] === \"function\";\n","export const isArrayLike = (x) => x != null && typeof x !== \"function\" && x.length !== undefined;\n","export const isIterable = (x) => x != null && typeof x[Symbol.iterator] === \"function\";\n","export const DEFAULT_EPS = 1e-6;\n/**\n * Internal use only. **Do NOT use in user land code!**\n *\n * @internal\n */\nexport const SEMAPHORE = Symbol();\n/**\n * No-effect placeholder function.\n */\nexport const NO_OP = () => { };\n/**\n * Catch-all event ID\n */\nexport const EVENT_ALL = \"*\";\nexport const EVENT_ENABLE = \"enable\";\nexport const EVENT_DISABLE = \"disable\";\n","import { implementsFunction } from \"@thi.ng/checks\";\nexport const ensureTransducer = (x) => implementsFunction(x, \"xform\")\n    ? x.xform()\n    : x;\n","export class Reduced {\n    constructor(val) {\n        this.value = val;\n    }\n    deref() {\n        return this.value;\n    }\n}\nexport const reduced = (x) => new Reduced(x);\nexport const isReduced = (x) => x instanceof Reduced;\nexport const ensureReduced = (x) => x instanceof Reduced ? x : new Reduced(x);\nexport const unreduced = (x) => (x instanceof Reduced ? x.deref() : x);\n","import { defError } from \"./deferror\";\nexport const IllegalArityError = defError(() => \"illegal arity\");\nexport const illegalArity = (n) => {\n    throw new IllegalArityError(n);\n};\n","import { implementsFunction, isArrayLike, isIterable } from \"@thi.ng/checks\";\nimport { illegalArity } from \"@thi.ng/errors\";\nimport { isReduced, unreduced } from \"./reduced\";\nconst parseArgs = (args) => args.length === 2\n    ? [undefined, args[1]]\n    : args.length === 3\n        ? [args[1], args[2]]\n        : illegalArity(args.length);\nexport function reduce(...args) {\n    const rfn = args[0];\n    const init = rfn[0];\n    const complete = rfn[1];\n    const reduce = rfn[2];\n    args = parseArgs(args);\n    const acc = args[0] == null ? init() : args[0];\n    const xs = args[1];\n    return unreduced(complete(implementsFunction(xs, \"$reduce\")\n        ? xs.$reduce(reduce, acc)\n        : isArrayLike(xs)\n            ? reduceArray(reduce, acc, xs)\n            : reduceIterable(reduce, acc, xs)));\n}\nexport function reduceRight(...args) {\n    const rfn = args[0];\n    const init = rfn[0];\n    const complete = rfn[1];\n    const reduce = rfn[2];\n    args = parseArgs(args);\n    let acc = args[0] == null ? init() : args[0];\n    const xs = args[1];\n    for (let i = xs.length; --i >= 0;) {\n        acc = reduce(acc, xs[i]);\n        if (isReduced(acc)) {\n            acc = acc.deref();\n            break;\n        }\n    }\n    return unreduced(complete(acc));\n}\nconst reduceArray = (rfn, acc, xs) => {\n    for (let i = 0, n = xs.length; i < n; i++) {\n        acc = rfn(acc, xs[i]);\n        if (isReduced(acc)) {\n            acc = acc.deref();\n            break;\n        }\n    }\n    return acc;\n};\nconst reduceIterable = (rfn, acc, xs) => {\n    for (let x of xs) {\n        acc = rfn(acc, x);\n        if (isReduced(acc)) {\n            acc = acc.deref();\n            break;\n        }\n    }\n    return acc;\n};\n/**\n * Convenience helper for building a full {@link Reducer} using the identity\n * function (i.e. `(x) => x`) as completion step (true for 90% of all\n * bundled transducers).\n *\n * @param init - init step of reducer\n * @param rfn - reduction step of reducer\n */\nexport const reducer = (init, rfn) => [init, (acc) => acc, rfn];\nexport const $$reduce = (rfn, args) => {\n    const n = args.length - 1;\n    return isIterable(args[n])\n        ? args.length > 1\n            ? reduce(rfn.apply(null, args.slice(0, n)), args[n])\n            : reduce(rfn(), args[0])\n        : undefined;\n};\n","import { reducer } from \"../reduce\";\nexport function push(xs) {\n    return xs\n        ? [...xs]\n        : reducer(() => [], (acc, x) => (acc.push(x), acc));\n}\n","import { NO_OP, SEMAPHORE } from \"@thi.ng/api\";\nimport { isIterable } from \"@thi.ng/checks\";\nimport { ensureTransducer } from \"./internal/ensure\";\nimport { isReduced, unreduced } from \"./reduced\";\nimport { push } from \"./rfn/push\";\n/**\n * Takes a transducer and input iterable. Returns iterator of\n * transformed results.\n *\n * @param xform -\n * @param xs -\n */\nexport function* iterator(xform, xs) {\n    const rfn = ensureTransducer(xform)(push());\n    const complete = rfn[1];\n    const reduce = rfn[2];\n    for (let x of xs) {\n        const y = reduce([], x);\n        if (isReduced(y)) {\n            yield* unreduced(complete(y.deref()));\n            return;\n        }\n        if (y.length) {\n            yield* y;\n        }\n    }\n    yield* unreduced(complete([]));\n}\n/**\n * Optimized version of {@link iterator} for transducers which are\n * guaranteed to:\n *\n * 1) Only produce none or a single result per input\n * 2) Do not require a `completion` reduction step\n *\n * @param xform -\n * @param xs -\n */\nexport function* iterator1(xform, xs) {\n    const reduce = (ensureTransducer(xform)([NO_OP, NO_OP, (_, x) => x]))[2];\n    for (let x of xs) {\n        let y = reduce(SEMAPHORE, x);\n        if (isReduced(y)) {\n            y = unreduced(y.deref());\n            if (y !== SEMAPHORE) {\n                yield y;\n            }\n            return;\n        }\n        if (y !== SEMAPHORE) {\n            yield y;\n        }\n    }\n}\n/**\n * Helper function used by various transducers to wrap themselves as\n * transforming iterators. Delegates to {@link iterator1} by default.\n *\n * @param xform -\n * @param args -\n * @param impl -\n *\n * @internal\n */\nexport const $iter = (xform, args, impl = iterator1) => {\n    const n = args.length - 1;\n    return isIterable(args[n])\n        ? args.length > 1\n            ? impl(xform.apply(null, args.slice(0, n)), args[n])\n            : impl(xform(), args[0])\n        : undefined;\n};\n","/**\n * Reducer composition helper, internally used by various transducers\n * during initialization. Takes existing reducer `rfn` (a 3-tuple) and a\n * reducing function `fn`. Returns a new reducer tuple.\n *\n * @remarks\n * `rfn[2]` reduces values of type `B` into an accumulator of type `A`.\n * `fn` accepts values of type `C` and produces interim results of type\n * `B`, which are then (possibly) passed to the \"inner\" `rfn[2]`\n * function. Therefore the resulting reducer takes inputs of `C` and an\n * accumulator of type `A`.\n *\n * It is assumed that `fn` internally calls `rfn[2]` to pass its own\n * results for further processing by the nested reducer `rfn`.\n *\n * @example\n * ```ts\n * compR(rfn, fn)\n * // [rfn[0], rfn[1], fn]\n * ```\n *\n * @param rfn -\n * @param fn -\n */\nexport const compR = (rfn, fn) => [rfn[0], rfn[1], fn];\n","import { isIterable } from \"@thi.ng/checks\";\nimport { compR } from \"../func/compr\";\nimport { iterator1 } from \"../iterator\";\nexport function map(fn, src) {\n    return isIterable(src)\n        ? iterator1(map(fn), src)\n        : (rfn) => {\n            const r = rfn[2];\n            return compR(rfn, (acc, x) => r(acc, fn(x)));\n        };\n}\n"],"names":[],"mappings":"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"}