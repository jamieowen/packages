{"version":3,"file":"texture-9eea8e8b.js","sources":["../../../../../node_modules/@thi.ng/shader-ast/builtin/texture.js"],"sourcesContent":["import { illegalArgs } from \"@thi.ng/errors\";\nimport { isVec } from \"../ast/checks\";\nimport { builtinCall } from \"../ast/function\";\nconst texRetType = (sampler) => {\n    const t = sampler.type[0];\n    const shadow = sampler.type.indexOf(\"Shadow\") > 0;\n    return t === \"s\"\n        ? shadow\n            ? \"float\"\n            : \"vec4\"\n        : t === \"i\"\n            ? shadow\n                ? \"int\"\n                : \"ivec4\"\n            : t === \"u\"\n                ? shadow\n                    ? \"uint\"\n                    : \"uvec4\"\n                : illegalArgs(`unknown sampler type ${sampler.type}`);\n};\nconst $call = (name, sampler, args, bias) => {\n    const f = bias\n        ? builtinCall(name, texRetType(sampler), sampler, ...args, bias)\n        : builtinCall(name, texRetType(sampler), sampler, ...args);\n    !isVec(f) && (f.info = \"n\");\n    return f;\n};\n// prettier-ignore\nexport function textureSize(sampler, lod) {\n    return builtinCall(\"textureSize\", /(3D|Array)/.test(sampler.type) ? \"ivec3\" : \"ivec2\", sampler, lod);\n}\n// prettier-ignore\nexport function texture(sampler, uv, bias) {\n    return $call(\"texture\", sampler, [uv], bias);\n}\n// prettier-ignore\nexport function textureProj(sampler, uv, bias) {\n    return $call(\"textureProj\", sampler, [uv], bias);\n}\n// prettier-ignore\nexport function textureLod(sampler, uv, lod) {\n    return $call(\"textureLod\", sampler, [uv, lod]);\n}\n// prettier-ignore\nexport function textureOffset(sampler, uv, off, bias) {\n    return $call(\"textureOffset\", sampler, [uv, off], bias);\n}\n// prettier-ignore\nexport function texelFetch(sampler, uv, lod) {\n    return $call(\"texelFetch\", sampler, [uv, lod]);\n}\n// prettier-ignore\nexport function texelFetchOffset(sampler, uv, lod, offset) {\n    return $call(\"texelFetchOffset\", sampler, [uv, lod, offset]);\n}\n// prettier-ignore\nexport function textureProjOffset(sampler, uv, off, bias) {\n    return $call(\"textureProjOffset\", sampler, [uv, off], bias);\n}\n// prettier-ignore\nexport function texelLodOffset(sampler, uv, lod, offset) {\n    return $call(\"texelLodOffset\", sampler, [uv, lod, offset]);\n}\n// prettier-ignore\nexport function textureProjLod(sampler, uv, lod) {\n    return $call(\"textureProjLod\", sampler, [uv, lod]);\n}\n// prettier-ignore\nexport function texelProjLodOffset(sampler, uv, lod, offset) {\n    return $call(\"texelProjLodOffset\", sampler, [uv, lod, offset]);\n}\n// prettier-ignore\nexport function textureGrad(sampler, uvw, dx, dy) {\n    return $call(\"textureGrad\", sampler, [uvw, dx, dy]);\n}\n// prettier-ignore\nexport function textureGradOffset(sampler, uvw, dx, dy, offset) {\n    return $call(\"textureGradOffset\", sampler, [uvw, dx, dy, offset]);\n}\n// prettier-ignore\nexport function textureProjGrad(sampler, uvw, dx, dy) {\n    return $call(\"textureProjGrad\", sampler, [uvw, dx, dy]);\n}\n// prettier-ignore\nexport function textureProjGradOffset(sampler, uvw, dx, dy, offset) {\n    return $call(\"textureProjGradOffset\", sampler, [uvw, dx, dy, offset]);\n}\nexport const dFdx = (sym) => builtinCall(\"dFdx\", sym.type, sym);\nexport const dFdy = (sym) => builtinCall(\"dFdy\", sym.type, sym);\nexport const fwidth = (sym) => builtinCall(\"fwidth\", sym.type, sym);\n"],"names":[],"mappings":";;;;AAGA,MAAM,UAAU,GAAG,CAAC,OAAO,KAAK;AAChC,IAAI,MAAM,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAC9B,IAAI,MAAM,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;AACtD,IAAI,OAAO,CAAC,KAAK,GAAG;AACpB,UAAU,MAAM;AAChB,cAAc,OAAO;AACrB,cAAc,MAAM;AACpB,UAAU,CAAC,KAAK,GAAG;AACnB,cAAc,MAAM;AACpB,kBAAkB,KAAK;AACvB,kBAAkB,OAAO;AACzB,cAAc,CAAC,KAAK,GAAG;AACvB,kBAAkB,MAAM;AACxB,sBAAsB,MAAM;AAC5B,sBAAsB,OAAO;AAC7B,kBAAkB,WAAW,CAAC,CAAC,qBAAqB,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACtE,CAAC,CAAC;AACF,MAAM,KAAK,GAAG,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,KAAK;AAC7C,IAAI,MAAM,CAAC,GAAG,IAAI;AAClB,UAAU,WAAW,CAAC,IAAI,EAAE,UAAU,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,GAAG,IAAI,EAAE,IAAI,CAAC;AACxE,UAAU,WAAW,CAAC,IAAI,EAAE,UAAU,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;AACnE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;AAChC,IAAI,OAAO,CAAC,CAAC;AACb,CAAC,CAAC;AAKF;AACO,SAAS,OAAO,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE;AAC3C,IAAI,OAAO,KAAK,CAAC,SAAS,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;AACjD;;;;"}