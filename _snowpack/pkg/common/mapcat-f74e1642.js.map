{"version":3,"file":"mapcat-f74e1642.js","sources":["../../../../../node_modules/@thi.ng/transducers/xform/cat.js","../../../../../node_modules/@thi.ng/transducers/iter/range2d.js","../../../../../node_modules/@thi.ng/transducers/xform/mapcat.js"],"sourcesContent":["import { compR } from \"../func/compr\";\nimport { ensureReduced, isReduced, unreduced } from \"../reduced\";\n/**\n * Transducer to concatenate iterable values. Iterates over each input\n * and emits individual values down stream, therefore removing one level\n * of nesting from the input.\n *\n * @remarks\n * If, during processing, the transducer is given a wrapped reduced\n * input iterable, it will still be processed as normal, but then\n * immediately triggers early termination by wrapping its own result in\n * {@link reduced}. E.g. this behavior allows a {@link (mapcat:1)} user\n * functions to benefit from reduced results.\n *\n * Also see:\n * - {@link concat}\n * - {@link (mapcat:1)}\n *\n * @example\n * ```ts\n * [...iterator(comp(map((x) => [x, x]), cat()), [1, 2, 3, 4])]\n * // [ 1, 1, 2, 2, 3, 3, 4, 4 ]\n *\n * [...iterator(\n *   comp(\n *     mapIndexed((i, x) => [[i], [x, x]]),\n *     cat(),\n *     cat()\n *   ),\n *   \"abc\"\n * )]\n * // [ 0, 'a', 'a', 1, 'b', 'b', 2, 'c', 'c' ]\n *\n * [...mapcat((x)=>(x > 1 ? reduced([x, x]) : [x, x]), [1, 2, 3, 4])]\n * // [ 1, 1, 2, 2 ]\n * ```\n *\n * @param rfn -\n */\nexport const cat = () => (rfn) => {\n    const r = rfn[2];\n    return compR(rfn, (acc, x) => {\n        if (x) {\n            for (let y of unreduced(x)) {\n                acc = r(acc, y);\n                if (isReduced(acc)) {\n                    break;\n                }\n            }\n        }\n        return isReduced(x) ? ensureReduced(acc) : acc;\n    });\n};\n","import { illegalArity } from \"@thi.ng/errors\";\nimport { range } from \"./range\";\nexport function* range2d(...args) {\n    let fromX, toX, stepX;\n    let fromY, toY, stepY;\n    switch (args.length) {\n        case 6:\n            stepX = args[4];\n            stepY = args[5];\n        case 4:\n            [fromX, toX, fromY, toY] = args;\n            break;\n        case 2:\n            [toX, toY] = args;\n            fromX = fromY = 0;\n            break;\n        default:\n            illegalArity(args.length);\n    }\n    const rx = range(fromX, toX, stepX);\n    for (let y of range(fromY, toY, stepY)) {\n        for (let x of rx) {\n            yield [x, y];\n        }\n    }\n}\n","import { isIterable } from \"@thi.ng/checks\";\nimport { comp } from \"../func/comp\";\nimport { iterator } from \"../iterator\";\nimport { cat } from \"./cat\";\nimport { map } from \"./map\";\nexport function mapcat(fn, src) {\n    return isIterable(src) ? iterator(mapcat(fn), src) : comp(map(fn), cat());\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAM,GAAG,GAAG,MAAM,CAAC,GAAG,KAAK;AAClC,IAAI,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;AACrB,IAAI,OAAO,KAAK,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK;AAClC,QAAQ,IAAI,CAAC,EAAE;AACf,YAAY,KAAK,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;AACxC,gBAAgB,GAAG,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;AAChC,gBAAgB,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE;AACpC,oBAAoB,MAAM;AAC1B,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT,QAAQ,OAAO,SAAS,CAAC,CAAC,CAAC,GAAG,aAAa,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;AACvD,KAAK,CAAC,CAAC;AACP,CAAC;;AClDM,UAAU,OAAO,CAAC,GAAG,IAAI,EAAE;AAClC,IAAI,IAAI,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC;AAC1B,IAAI,IAAI,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC;AAC1B,IAAI,QAAQ,IAAI,CAAC,MAAM;AACvB,QAAQ,KAAK,CAAC;AACd,YAAY,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AAC5B,YAAY,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AAC5B,QAAQ,KAAK,CAAC;AACd,YAAY,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;AAC5C,YAAY,MAAM;AAClB,QAAQ,KAAK,CAAC;AACd,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;AAC9B,YAAY,KAAK,GAAG,KAAK,GAAG,CAAC,CAAC;AAC9B,YAAY,MAAM;AAClB,QAAQ;AACR,YAAY,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACtC,KAAK;AACL,IAAI,MAAM,EAAE,GAAG,KAAK,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;AACxC,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC,EAAE;AAC5C,QAAQ,KAAK,IAAI,CAAC,IAAI,EAAE,EAAE;AAC1B,YAAY,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACzB,SAAS;AACT,KAAK;AACL;;ACpBO,SAAS,MAAM,CAAC,EAAE,EAAE,GAAG,EAAE;AAChC,IAAI,OAAO,UAAU,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;AAC9E;;;;"}